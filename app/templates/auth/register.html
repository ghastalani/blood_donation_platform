{% extends "base.html" %}

{% block content %}
<h2>{{ get_text('register') }}</h2>
<form method="POST">
    <div class="form-group">
        <label>{{ get_text('role') }}</label>
        <div class="radio-group">
            <label style="margin-right: 15px;">
                <input type="radio" name="role" value="donor" id="role_donor" required> {{ get_text('donor') }}
            </label>
            <label>
                <input type="radio" name="role" value="requester" id="role_requester"> {{ get_text('requester') }}
            </label>
        </div>
    </div>

    <label for="name">{{ get_text('name') }}:</label>
    <input type="text" name="name" id="name" required>

    <label for="phone">{{ get_text('phone') }}:</label>
    <input type="tel" name="phone" id="phone" required>

    <label for="email">{{ get_text('email') }}:</label>
    <input type="email" name="email" id="email">

    <label for="password">{{ get_text('password') }}:</label>
    <input type="password" name="password" id="password" required>

    <label for="city">{{ get_text('city') }}:</label>
    <input type="text" name="city" id="city" required>

    <div id="blood-group-container" style="display:none;">
        <label for="blood_type">{{ get_text('blood_type') }}:</label>
        <select name="blood_type" id="blood_type">
            <option value="">{{ get_text('select') }}</option>
            <option value="A+">A+</option>
            <option value="A-">A-</option>
            <option value="B+">B+</option>
            <option value="B-">B-</option>
            <option value="AB+">AB+</option>
            <option value="AB-">AB-</option>
            <option value="O+">O+</option>
            <option value="O-">O-</option>
            <option value="Unknown">{{ get_text('unknown') }}</option>
        </select>
    </div>

    <div id="nni-container">
        <label for="nni">{{ get_text('nni') }}:</label>
        <input type="text" name="nni" id="nni">
        <small class="form-text text-muted">Required for verification.</small>
    </div>

    <button type="submit" class="btn">{{ get_text('submit') }}</button>
    <p style="margin-top: 1rem;"><a href="{{ url_for('auth.login') }}">&larr; {{ get_text('back') }}</a></p>
</form>

<script>
    const roleDonor = document.getElementById('role_donor');
    const roleRequester = document.getElementById('role_requester');
    const bloodContainer = document.getElementById('blood-group-container');
    const bloodSelect = document.getElementById('blood_type');

    function toggleFields() {
        if (roleDonor.checked) {
            bloodContainer.style.display = 'block';
            bloodSelect.required = true;
        } else {
            bloodContainer.style.display = 'none';
            bloodSelect.required = false;
        }
    }

    const radios = document.querySelectorAll('input[name="role"]');
    radios.forEach(radio => radio.addEventListener('change', toggleFields));
    toggleFields(); // Initial check
</script>
{% endblock %}